# デジタルヒューマン機能 製品要求仕様書 (PRD)

## 1. 概要

本ドキュメントは、既存のチャットボットアプリケーションに「デジタルヒューマンとのリアルタイム対話機能」を追加するための製品要求仕様を定義するものです。

### 1.1. 背景と目的

テキストベースのチャットボット対話に加え、より人間らしく自然なコミュニケーション体験を提供するため、デジタルヒューマン機能を統合します。ユーザーは視覚的・聴覚的に豊かなインタラクションを通じて、エンゲージメントの向上を図ることを目的とします。

### 1.2. ターゲットユーザー

-   既存のチャットボットを利用するすべてのユーザー
-   より高度なユーザー体験を求める企業および開発者

## 2. 機能要求

### 2.1. デジタルヒューマン表示機能

-   **機能**: チャットボット画面上に配置された特定のボタンを押下すると、デジタルヒューマンが画面に表示される。
-   **トリガー**: ユーザーによる「デジタルヒューマンと話す」ボタン（仮称）のクリック。
-   **表示**: デフォルトのアバター（例: `role: 250623-zhibo-linyunzhi`）が、指定された背景と共に表示される。

### 2.2. リアルタイム対話機能

ユーザーの発話を認識し、デジタルヒューマンがリアルタイムで音声応答する機能。

-   **音声入力 (STT - Speech-to-Text)**
    -   ユーザーのマイク入力を受け付け、リアルタイムでテキストに変換する。
    -   利用技術: BytePlus STT
-   **応答生成 (LLM)**
    -   STTによってテキスト化されたユーザーの質問を既存のチャットボットバックエンド（LLM）に送信し、回答テキストを生成する。
-   **音声合成 (TTS - Text-to-Speech)**
    -   LLMが生成した回答テキストを、自然な音声に変換する。
    -   利用技術: BytePlus TTS（カスタムボイス対応）
-   **リップシンクとストリーミング (RTC - Real-Time Communication)**
    -   生成された音声を基に、デジタルヒューマンの口パクや表情をリアルタイムで生成する。
    -   生成された映像と音声を、Websocketプロトコルを通じてクライアントにストリーミング配信する。
    -   利用技術: BytePlus RTC

### 2.3. ユーザーインターフェース (UI)

-   チャット画面に「デジタルヒューマンと話す」ボタンを設置する。
-   デジタルヒューマン表示エリアを設ける。
-   マイクのON/OFFを制御するボタンを設置する。

## 3. 技術要件

-   **フロントエンド**:
    -   既存のReactアプリケーション (`QuickStart_React_BytePlus_4.66_16`) をベースに改修。
    -   Websocketクライアントを実装し、BytePlus Digital Humanサービスとの通信を確立する。
    -   BytePlus RTC SDKを統合し、ストリーミング映像を受信・再生する。
-   **バックエンド**:
    -   既存のチャットボットバックエンドを利用し、LLMからの応答テキストを取得する。
-   **利用サービス (BytePlus)**:
    -   **Digital Human**: 3min Avatar (Streaming)
    -   **RTC**: BytePlus RTC
    -   **TTS**: BytePlus TTS
    -   **STT**: BytePlus STT
-   **通信プロトコル**:
    -   [数字人交互 Websocket 通信协议-外部](docs/数字人交互%20Websocket%20通信协议-外部.md) に準拠する。

## 4. 非機能要求

-   **パフォーマンス**: ユーザーの発話からデジタルヒューマンの応答開始までの遅延を最小限に抑え、リアルタイムな対話体験を実現する。
-   **セキュリティ**: APIキーやトークンなどの認証情報は、安全な方法で管理・利用する。
-   **スケーラビリティ**: POC（概念実証）段階では、提供されるテストアカウントの同時接続数（1並列）の範囲で動作すること。

## 5. POC（概念実証）の範囲

-   本プロジェクトはPOCと位置づけ、提供されたテストアカウント情報を用いて実装する。
    -   `appid: 345ik21igy28owu2`
    -   `token: g2aaPHk1j7TCP8tN0cIUBJVHoCUn5CHn`
-   デジタルヒューマンのアバターは、デフォルトの `role: 250623-zhibo-linyunzhi` を使用する。
-   音声復刻（Voice Replication）は、提供されたサンプルコードとドキュメントを参考に検証を行うが、本機能の必須実装範囲には含めない。